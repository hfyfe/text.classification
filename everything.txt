
C = .4 ;
cycles = 20 ; 
textcount = 160 ; 
samplecount = 120 ;
wordcount = 363;

Truth = zeros(textcount,1) ;
%remember, set this parameter manually depending on which set of texts
Truth(41:80) = 1 ;


testcount = textcount - samplecount ; 
weights = zeros (cycles, wordcount) ;
recall = zeros(cycles,1) ;
accuracy = zeros(cycles,1);
A = zeros(textcount,wordcount);

storylist = {
    '/Users/henryfyfe/Desktop/orf307project/fairytale/aesops fairytales.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/Alice in Wonderland.txt'
  '/Users/henryfyfe/Desktop/orf307project/fairytale/American Fairy Tales.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/ANDERSENS FAIRY TALES.txt'
  '/Users/henryfyfe/Desktop/orf307project/fairytale/At the Back of the North Wind.txt'

  '/Users/henryfyfe/Desktop/orf307project/fairytale/Celtic Tales told to Children.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/DUTCH FAIRY TALES FOR YOUNG FOLKS.txt'
  '/Users/henryfyfe/Desktop/orf307project/fairytale/Grimm Fairytales.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/INDIAN FAIRY TALES.txt'
        '/Users/henryfyfe/Desktop/orf307project/fairytale/IRISH FAIRY TALES.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/JAPANESE FAIRY TALES.txt'

  '/Users/henryfyfe/Desktop/orf307project/fairytale/Peter Pan.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/Phantastes.txt'
  '/Users/henryfyfe/Desktop/orf307project/fairytale/pinocchio.txt'
   
  '/Users/henryfyfe/Desktop/orf307project/fairytale/ROUMANIAN FAIRY TALES.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/The Admirals Caravan.txt'
        '/Users/henryfyfe/Desktop/orf307project/fairytale/The Birthday of the Infanta.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/The Blue Moon.txt'
  '/Users/henryfyfe/Desktop/orf307project/fairytale/The Boy Who Knew What the Birds Said.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/The Brown Fairy Book part 2.txt'
  '/Users/henryfyfe/Desktop/orf307project/fairytale/The Brown Fairy Book.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/The Crimson Fairy Book part 2.txt'
  '/Users/henryfyfe/Desktop/orf307project/fairytale/The Crimson Fairy Book.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/The Fisherman and his Soul.txt'
  
    '/Users/henryfyfe/Desktop/orf307project/fairytale/The Grey Fairy Book.txt'
      
    '/Users/henryfyfe/Desktop/orf307project/fairytale/The King of the Golden River.txt'
  '/Users/henryfyfe/Desktop/orf307project/fairytale/THE LITTLE LAME PRINCE.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/THE MAGIC FISHBONE.txt'

    '/Users/henryfyfe/Desktop/orf307project/fairytale/The Orange Fairy Book.txt'
  '/Users/henryfyfe/Desktop/orf307project/fairytale/The Pink Fairy Book part 2.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/The Pink Fairy Book.txt'
 
    '/Users/henryfyfe/Desktop/orf307project/fairytale/The Princess and the Goblin.txt'
        '/Users/henryfyfe/Desktop/orf307project/fairytale/The Red Romance Book part 2.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/THE SHADOW WITCH.txt'
 
    '/Users/henryfyfe/Desktop/orf307project/fairytale/The Young King.txt'
  '/Users/henryfyfe/Desktop/orf307project/fairytale/Through the Looking Glass.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/TWENTY-TWO GOBLINS.txt'
 
    '/Users/henryfyfe/Desktop/orf307project/fairytale/Undine.txt'
  '/Users/henryfyfe/Desktop/orf307project/fairytale/Welsh Fairy Tales.txt'
    '/Users/henryfyfe/Desktop/orf307project/fairytale/Wonderful Wizard of Oz.txt'

    '/Users/henryfyfe/Desktop/orf307project/mystery/An Historical Mystery.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Ashiel Mystery.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Club of Queer Trades.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Dead Mens Money.txt'
      '/Users/henryfyfe/Desktop/orf307project/mystery/File No. 113.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Haunted Hotel.txt'


    '/Users/henryfyfe/Desktop/orf307project/mystery/Innocence of Father Brown.txt'
      '/Users/henryfyfe/Desktop/orf307project/mystery/Manalive.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Mary Louise Solve a Mystery.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Max Carrados Detective Stories.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Mirror of Kong Ho.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Miss and Mrs..txt'
      '/Users/henryfyfe/Desktop/orf307project/mystery/My Friend the Murderer.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/My Ladys Money.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Mysterious Affair at Styles.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Mystery of Edwin Drood.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Nan Sherwood.txt'
      '/Users/henryfyfe/Desktop/orf307project/mystery/Queen of Hearts.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/R Holmes.txt'

    '/Users/henryfyfe/Desktop/orf307project/mystery/Tales of Terror and Mystery.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/That Mainwaring Affair.txt'

    '/Users/henryfyfe/Desktop/orf307project/mystery/The Adventure of the Cardboard Box.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/The Adventure of the Dying Detective.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/The Adventure of the Red Circle.txt'

      '/Users/henryfyfe/Desktop/orf307project/mystery/The Adventures of Sherlock Holmes.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/The Agony Column.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/The Borough Treasurer.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/The Hound of the Baskervilles.txt'

      '/Users/henryfyfe/Desktop/orf307project/mystery/The Man Who Knew Too Much.txt'

    '/Users/henryfyfe/Desktop/orf307project/mystery/The Middle Temple Murder.txt'

    '/Users/henryfyfe/Desktop/orf307project/mystery/The Mystery of 31 New Inn.txt'
      '/Users/henryfyfe/Desktop/orf307project/mystery/The Orange-Yellow Diamond.txt'

    '/Users/henryfyfe/Desktop/orf307project/mystery/The Sign of the Four.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/The Stark Munro Letters.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/The Trees of Pride.txt'
      '/Users/henryfyfe/Desktop/orf307project/mystery/The Valley of Fear.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Trents Last Case.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Triumphs .txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Wisdom of Father Brown.txt'
    '/Users/henryfyfe/Desktop/orf307project/mystery/Within the Law.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/A Theologico-Political Treatise part 1.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/A Theologico-Political Treatise part 2.txt'
    
    '/Users/henryfyfe/Desktop/orf307project/philosophy/A Theologico-Political Treatise part 4.txt'

        '/Users/henryfyfe/Desktop/orf307project/philosophy/Creative Unity by Rabindranath Tagore.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/Erewhon by Samuel Butler.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/Erewhon Revisited by Samuel Butler.txt'
   
    '/Users/henryfyfe/Desktop/orf307project/philosophy/FUNDAMENTAL PRINCIPLES OF THE METAPHYSIC OF MORALS.txt'
        '/Users/henryfyfe/Desktop/orf307project/philosophy/Humanistic Nursing by Josephine G. Paterson and Loretta T. Zderad.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/Laughter  an Essay on the Meaning of the Comic by Henri Bergson.txt'
   
    '/Users/henryfyfe/Desktop/orf307project/philosophy/Meditations by Emperor of Rome Marcus Aurelius.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/On the Improvement of the Understanding.txt'
        '/Users/henryfyfe/Desktop/orf307project/philosophy/Plato and Platonism by Walter Pater.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/PROPOSED ROADS TO FREEDOM.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/Sadhana  the realisation of life by Rabindranath Tagore.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/Sayings of Confucius.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/SELECTIONS FROM THE PRINCIPLES OF PHILOSOPHY.txt'
      
    '/Users/henryfyfe/Desktop/orf307project/philosophy/The Age of Reason by Paine.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/The Dore Lectures by Thomas Troward.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/The Antichrist by Friedrich Wilhelm Nietzsche.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/The Categories.txt'
      
    '/Users/henryfyfe/Desktop/orf307project/philosophy/The Critique of Pure Reason by Immanuel Kant.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/The Idea of Progress part 2.txt'
    
    '/Users/henryfyfe/Desktop/orf307project/philosophy/THE GOLDEN SAYINGS OF EPICTETUS.txt'
        '/Users/henryfyfe/Desktop/orf307project/philosophy/The Idea of Progress by J. B. Bury.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/THE METAPHYSICAL ELEMENTS OF ETHICS.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/The Ruins, or, Meditation on the Revolutions of Empires and the Law of Nature.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/The Tao Teh King, or the Tao and its Characteristics by Laozi.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/The Worlds Greatest Books  Volume 14  Philosophy and Economics by Various.txt'
        '/Users/henryfyfe/Desktop/orf307project/philosophy/Thoughts on Man, His Nature, Productions and Discoveries Interspersed with Some.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/Thoughts out of Season Part I by Friedrich Wilhelm Nietzsche.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/Laws of Plato part 2.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/Laws of Plato part 3.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/Plato and Platonism by Walter Pater part 2.txt'

    '/Users/henryfyfe/Desktop/orf307project/philosophy/THE EVOLUTION OF CAPITALISM part 2.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/The Ruins, or, Meditation on the Revolutions of Empires and the Law of Nature part 2.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/The Ruins, or, Meditation on the Revolutions of Empires and the Law of Nature part 3.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/Thus Spake Zarathustra by Friedrich Wilhelm Nietzsche.txt'
        '/Users/henryfyfe/Desktop/orf307project/philosophy/Varieties of Religious Experience, a Study in Human Nature by William James part 2.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/Varieties of Religious Experience, a Study in Human Nature by William James part 3.txt'

    '/Users/henryfyfe/Desktop/orf307project/philosophy/Varieties of Religious Experience, a Study in Human Nature by William James.txt'
    '/Users/henryfyfe/Desktop/orf307project/philosophy/VEDANTA PHILOSOPHY.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/A Son of the Immortals.txt'

      '/Users/henryfyfe/Desktop/orf307project/romance/An Algonquin Maiden.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/An Old Mans Love.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Awakening and to Let.txt'
       '/Users/henryfyfe/Desktop/orf307project/romance/Beulah.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Blue Bird Weather.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Can You Forgive Her?.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Castle Richmond.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Children of the Whirlwind.txt'
       '/Users/henryfyfe/Desktop/orf307project/romance/Comedies of Courtship.txt'

      '/Users/henryfyfe/Desktop/orf307project/romance/Far From the Madding Crowd.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Going Some.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Gone With the Wind.txt'
       '/Users/henryfyfe/Desktop/orf307project/romance/Indian Summer.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Jane Eyre.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Jude the Obscure.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Lady Susan.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Laodecian.txt'
       '/Users/henryfyfe/Desktop/orf307project/romance/Lavender and Old Lace.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Love and Friendship.txt'

      '/Users/henryfyfe/Desktop/orf307project/romance/Mansfield Park.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Mary Barton.txt'

      '/Users/henryfyfe/Desktop/orf307project/romance/Miss Mackenzie.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Northanger Abbey.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Old Love Stories Retold.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Pamela, or Virtue Rewarded.txt'

      '/Users/henryfyfe/Desktop/orf307project/romance/Portrait of a Lady, Vol 1.txt'

      '/Users/henryfyfe/Desktop/orf307project/romance/Pride and Prejudice.txt'

       '/Users/henryfyfe/Desktop/orf307project/romance/Scarlet Pimpernel.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Sense and Sensibility.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/She.txt'

      '/Users/henryfyfe/Desktop/orf307project/romance/The Claverings.txt'
       '/Users/henryfyfe/Desktop/orf307project/romance/The Last Chronicle of Barset.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/The Last Woman.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/The Little Gray Lady.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/The Range Dwellers.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/The Trumpet Major.txt'

      '/Users/henryfyfe/Desktop/orf307project/romance/Two on a Tower.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Violists.txt'
      '/Users/henryfyfe/Desktop/orf307project/romance/Wired Love.txt'

      } ;
  
%derive count of each word in each text thru wordlist function
for j = 1:textcount
    A(j,1:wordcount) = wordlist(storylist{j}) ; 
end


for i = 1:cycles
    
    %sample + test matrices and indexes
    samplepermuatation = zeros(samplecount,1) ;
    testpermutation = zeros (testcount ,1) ; 
    sampleperm = zeros(samplecount,wordcount) ;
    testperm = zeros(testcount,wordcount) ;
 
    %randomly separate sample and test set
    AorderPermutation = randperm(textcount) ;
    for j = 1:samplecount ;
        n = AorderPermutation(j) ; 
        sampleperm (j,1:wordcount) = A(n,1:wordcount) ;
        samplepermuatation(j) = Truth(n) ; 
    end  
    for j = 1:testcount
        n = AorderPermutation(j+samplecount) ;
        testperm(j,1:wordcount) = A(n,1:wordcount) ; 
        testpermutation(j) = Truth(n) ; 
    end

    %call optim function to format + run linear program 
    weightvector = optim(sampleperm,samplepermuatation,C) ;
    
    %withdraw pertinent vector weightings and estimate classification for
    %test set
    weights(i, 1:wordcount ) = 100*weightvector(samplecount + wordcount+1: samplecount + 2*wordcount); 
    estimate = testperm*weights(i,1:wordcount )' ; 

    %calculate performance of estimate
    falsep = 0 ;
    truep = 0 ;
    falsen = 0 ;
    for j = 1:testcount
        if (estimate(j) > 0)
            if (testpermutation(j) == 1 );
                truep = truep + 1 ;
            else
               falsep = falsep + 1 ; 
            end
        end
        if (estimate(j) < 0 && testpermutation(j) == 1);
            falsen = falsen + 1;
        end
    end
    accuracy(i) = truep /(falsep + truep) ; 
    recall(i) = truep/ (falsen + truep) ;
end

%sum of perforamnce 
waverage = mean(weights,1)    
recallavg = mean(recall) 
accuracyavg = mean(accuracy)   
sum = recallave+accuracyavg




